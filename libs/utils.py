import marshal, base64
exec(base64.b64decode("ZnJvbSByZXF1ZXN0cyBpbXBvcnQgU2Vzc2lvbgoKZGVmIENoZWNrUHVibGljSVAoKToKICAgIHRyeToKICAgICAgICB3aXRoIFNlc3Npb24oKSBhcyBzZXM6CiAgICAgICAgICAgIHJlcyA9IHNlcy5nZXQoImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZy8/Zm9ybWF0PWpzb24iKQogICAgICAgICAgICBpZiAocmVzLnN0YXR1c19jb2RlID09IDIwMCk6CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVsiaXAiXQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBOb25lCiAgICBwYXNzCiAgICAKZGVmIElzUHJveHlXb3JraW5nKHByb3h5KToKICAgIHRyeToKICAgICAgICB3aXRoIFNlc3Npb24oKSBhcyBzZXM6CiAgICAgICAgICAgIHNlcy5wcm94aWVzLnVwZGF0ZShwcm94eSkKICAgICAgICAgICAgcmVzID0gc2VzLmdldCgiaHR0cHM6Ly9hcGkuaXBpZnkub3JnLz9mb3JtYXQ9anNvbiIpCiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzX2NvZGUgPT0gMjAwKToKICAgICAgICAgICAgICAgIGlmKHJlcy5qc29uKClbImlwIl0gIT0gQ2hlY2tQdWJsaWNJUCgpIGFuZCBDaGVja1B1YmxpY0lQICE9IE5vbmUpOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQogICAgcGFzcwoKZGVmIFByaW50U3VjY2VzcyhtZXNzYWdlLCB1c2VybmFtZSwgKmFyZ3YpOgogICAgcHJpbnQoIlsgT0sgXSAiLCBlbmQ9IiIpCiAgICBwcmludCgiWyIsIGVuZD0iIikKICAgIHByaW50KHVzZXJuYW1lLCBlbmQ9IiIpCiAgICBwcmludCgiXSAiLCBlbmQ9IiIpCiAgICBwcmludChtZXNzYWdlLCBlbmQ9IiAiKQogICAgZm9yIGFyZyBpbiBhcmd2OgogICAgICAgIHByaW50KGFyZywgZW5kPSIgIikKICAgIHByaW50KCIiKQogICAgcGFzcwoKIyBTcGFtIDEKIyBEbyBub3QgaHVydCB5b3Vyc2VsZiAyCiMgRHJ1ZyAzCiMgTnVkaXR5IDQKIyBTZXZlcml0eSA1CiMgSGF0ZSBTcGVlY2ggNgojIEhhcmFzc21lbnQgYW5kIEJ1bGx5aW5nIDcKIyBJZGVudGl0eSBJbWl0YXRpb24gOAojIEFnZS1GcmVlIENoaWxkIDExCgpkZWYgUHJpbnRDaG9pY2VzKCk6CiAgICBwcmludCgiIiIgICAgCiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLSsKICAgIHwgICAgICAgIFJlYXNvbiAgICAgICAgICAgICAgfCBOdW1hcmEgfAogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0rCiAgICB8IFNwYW0gICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAxIHwKICAgIHwgRG8gbm90IGh1cnQgeW91cnNlbGYgICAgICAgfCAgICAgIDIgfAogICAgfCBEcnVnICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgMyB8CiAgICB8IE51ZGl0eSAgICAgICAgICAgICAgICAgICAgIHwgICAgICA0IHwKICAgIHwgU2V2ZXJpdHkgICAgICAgICAgICAgICAgICAgfCAgICAgIDUgfAogICAgfCBIYXRlIFNwZWVjaCAgICAgICAgICAgICAgICB8ICAgICAgNiB8CiAgICB8IEhhcmFzc21lbnQgYW5kIEJ1bGx5aW5nICAgIHwgICAgICA3IHwKICAgIHwgSWRlbnRpdHkgSW1pdGF0aW9uICAgICAgICAgfCAgICAgIDggfAogICAgfCBBZ2UtRnJlZSBDaGlsZCAgICAgICAgICAgICB8ICAgICAxMSB8CiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLSsKICAgICIiIikKCmRlZiBHZXRJbnB1dChtZXNzYWdlLCAqYXJndik6CiAgICBwcmludCgiWyA/IF0gIiwgZW5kPSIiKQogICAgcHJpbnQobWVzc2FnZSwgZW5kPSIgIikKICAgIGZvciBhcmcgaW4gYXJndjoKICAgICAgICBwcmludChhcmcsIGVuZD0iICIpCiAgICByZXR1cm4gaW5wdXQoKQoKZGVmIFByaW50RmF0YWxFcnJvcihtZXNzYWdlLCAqYXJndik6CiAgICBwcmludCgiWyBYIF0gIiwgZW5kPSIiKQogICAgcHJpbnQobWVzc2FnZSwgZW5kPSIgIikKICAgIGZvciBhcmcgaW4gYXJndjoKICAgICAgICBwcmludChhcmcsIGVuZD0iICIpCiAgICBwcmludCgiIikKICAgIHBhc3MKCmRlZiBQcmludEVycm9yKG1lc3NhZ2UsIHVzZXJuYW1lLCAqYXJndik6CiAgICBwcmludCgiWyBYIF0gIiwgZW5kPSIiKQogICAgcHJpbnQoIlsiLCBlbmQ9IiIpCiAgICBwcmludCh1c2VybmFtZSwgZW5kPSIiKQogICAgcHJpbnQoIl0gIiwgZW5kPSIiKQogICAgcHJpbnQobWVzc2FnZSwgZW5kPSIgIikKICAgIGZvciBhcmcgaW4gYXJndjoKICAgICAgICBwcmludChhcmcsIGVuZD0iICIpCiAgICBwcmludCgiIikKICAgIHBhc3MKCmRlZiBQcmludFN0YXR1cyhtZXNzYWdlLCAqYXJndik6CiAgICBwcmludCgiWyAqIF0gIiwgZW5kPSIiKQogICAgcHJpbnQobWVzc2FnZSwgZW5kPSIgIikKICAgIGZvciBhcmcgaW4gYXJndjoKICAgICAgICBwcmludChhcmcsIGVuZD0iICIpCiAgICBwcmludCgiIikKICAgIHBhc3MKCmRlZiBQcmludEJhbm5lcigpOgogICAgYmFubmVyID0gIiIiCuKUgOKUgOKWhOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWhOKUgOKUgAogIOKWhOKWiOKWgOKWkeKWiOKWkeKWiOKWkeKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWgOKWiOKWhAogIOKWiOKWkeKWkeKWkeKWiOKWkeKWiOKWkeKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWiOKWkeKWiOKWkeKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWiOKWkeKWiOKWkeKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWhOKWhOKWhOKWiOKWiOKWiOKWiOKWiOKWhOKWhOKWhOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWgOKWgOKWkeKWkeKWkeKWkeKWkeKWgOKWgOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWkeKWhOKWiOKWiOKWiOKWiOKWiOKWhOKWkeKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWiOKWiOKWgOKWkeKWkeKWkeKWgOKWiOKWiOKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWkeKWiOKWiOKWhOKWkeKWkeKWkeKWhOKWiOKWiOKWkeKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWhOKWkeKWgOKWiOKWiOKWiOKWiOKWiOKWgOKWkeKWhOKWiOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWgOKWiOKWiOKWhOKWhOKWkeKWkeKWkeKWhOKWhOKWiOKWiOKWgOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWgOKWgOKWiOKWiOKWiOKWiOKWiOKWgOKWgOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkWluc3RhcmVwb3J04paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paR4paICiAg4paI4paR4paR4paR4paRIEJ5IEBzaHViaGFtX2cwc2FpbuKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWiOKWkeKWkeKWkeKWkUJMQUNLLUtJTExFUuKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWiAogIOKWgOKWiOKWhOKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWkeKWhOKWiOKWgAogIOKUgOKUgOKWgOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWgOKUgAogICAgIiIiCiAgICBwcmludChiYW5uZXIpCiAgICBwYXNzCgpkZWYgTG9hZFVzZXJzKHBhdGgpOgogICAgcmV0ID0gW10KICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4ocGF0aCwgJ3InKSBhcyBmaWxlOgogICAgICAgICAgICBmb3IgbGluZSBpbiBmaWxlLnJlYWRsaW5lcygpOgogICAgICAgICAgICAgICAgbGluZSA9IGxpbmUucmVwbGFjZSgiXG4iLCAiIikucmVwbGFjZSgiXHIiLCIiKQogICAgICAgICAgICAgICAgdXNlciA9IGxpbmUuc3BsaXQoIiAiKVswXQogICAgICAgICAgICAgICAgcGFzc3dvcmQgPSBsaW5lLnNwbGl0KCIgIilbMV0KICAgICAgICAgICAgICAgIHJldC5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJ1c2VyIjogdXNlciwKICAgICAgICAgICAgICAgICAgICAicGFzc3dvcmQiOiBwYXNzd29yZAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgcGFzcwogICAgICAgIHJldHVybiByZXQKICAgIGV4Y2VwdDoKICAgICAgICBQcmludEZhdGFsRXJyb3IoIid1c2Vycy50eHQnIEZpbGUgbm90IGZvdW5kISIpCiAgICAgICAgZXhpdCgwKQogICAgcGFzcwoKZGVmIExvYWRQcm94aWVzKHBhdGgpOgogICAgcmV0ID0gW10KICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4ocGF0aCwgJ3InKSBhcyBmaWxlOgogICAgICAgICAgICBmb3IgbGluZSBpbiBmaWxlLnJlYWRsaW5lcygpOgogICAgICAgICAgICAgICAgbGluZSA9IGxpbmUucmVwbGFjZSgiXG4iLCAiIikucmVwbGFjZSgiXHIiLCIiKQogICAgICAgICAgICAgICAgaXAgPSBsaW5lLnNwbGl0KCI6IilbMF0KICAgICAgICAgICAgICAgIHBvcnQgPSBsaW5lLnNwbGl0KCI6IilbMV0KICAgICAgICAgICAgICAgIHJldC5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJpcCI6IGlwLAogICAgICAgICAgICAgICAgICAgICJwb3J0IjogcG9ydAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgcGFzcwogICAgICAgIHJldHVybiByZXQKICAgIGV4Y2VwdDoKICAgICAgICBQcmludEZhdGFsRXJyb3IoIidwcm94eS50eHQnIEZpbGUgbm90IGZvdW5kISIpCiAgICAgICAgZXhpdCgwKQogICAgcGFzcwo="))
